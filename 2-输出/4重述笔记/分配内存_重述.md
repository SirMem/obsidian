---
due: 2023-10-16
title: 分配内存_重述
tags:
  - C语言
---


> [!summary]+ summary
> 简要说明分配内存的方式


# 🤔问题:
## 分配内存有什么用处





# 🤔区别:




# 📘自我重述
## 分配内存的概述
分配内存就是请求操作系统提供一块内存，然后在程序中使用这块内存来存储数据。这个概念对于处理不确定大小的数据或需要动态创建数据结构非常重要。

## 分配函数介绍
### malloc()
`malloc`（memory allocation）函数分配一块指定大小的内存块，但不对其进行初始化。这意味着分配的内存块的内容可能包含任意值，取决于之前在相同内存位置上的数据。
`malloc` 接受一个参数，即要分配的字节数，然后返回一个指向新分配内存的指针。
`malloc` 和 `calloc` 在成功分配内存时都返回指向分配内存的指针。如果分配失败，它们都返回`NULL`指针，表示分配失败。
#### malloc()应用例
```c
double * ptd;
ptd = (double *) malloc(30 * sizeof(double));
```
以上代码为30个double类型的值请求内存空间，并设置ptd指向该位置。
注意，指针ptd被声明为指向一个double类型，而不是指向内含30个double类型值的块。数组名是该数组首元素的地址。
因此，如果让ptd指向这个块的首元素，便可像使用数组名一样使用它。也就是说，可以使用表达式ptd\[0]访问该块的首元素，ptd\[1]访问第2个元素，以此类推。可以使用数组名来表示指针，也可以用指针来表示数组。

### calloc()
`calloc`（contiguous allocation）函数分配一块指定大小的内存块，同时将所有位都设置为零，即进行初始化。这使得分配的内存块的内容始终是零。
`calloc` 接受两个参数，第一个参数是要分配的块数，第二个参数是每个块的大小（字节数），然后返回一个指向新分配内存的指针。它相当于分配了（块数 * 每块大小）个字节的内存。
`malloc` 和 `calloc` 在成功分配内存时都返回指向分配内存的指针。如果分配失败，它们都返回`NULL`指针，表示分配失败。
#### 示例
```c
long *newmem;
newmem = (long*)calloc(100,sizeof(long));
```

### free()
`free` 函数用于释放先前分配的内存块，使其可供系统回收和重复使用
动态分配的内存数量只会增加，除非用 free()进行释放。

### exit()
如果内存分配失败，可以调用 exit()函数结束程序，其原型在stdlib.h中。
EXIT_FAILURE的值也被定义在stdlib.h中。标准提供了两个返回值以保证在所有操作系统中都能正常工作:EXIT_SUCCESS（或者，相当于0）表示普通的程序结束， EXIT_FAILURE 表示程序异常中止。



